<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Twin Factory - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="navbar">
            <a href="/" class="navbar-brand">üè≠ Digital Twin Factory</a>
            <ul class="navbar-menu">
                <li class="navbar-item"><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="navbar-item"><a href="/generator">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</a></li>
                <li class="navbar-item"><a href="/jobs">–ó–∞–¥–∞—á–∏</a></li>
                <li class="navbar-item active"><a href="/analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                <li class="navbar-item"><a href="/api/docs">API</a></li>
            </ul>
        </nav>

        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <div class="card">
            <h1 class="card-title">üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –∏–Ω—Å–∞–π—Ç—ã</h1>
            <p style="color: #6c757d;">–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π</p>
        </div>

        <!-- KPI Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">üë•</div>
                <div class="stat-label">–í—Å–µ–≥–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤</div>
                <div class="stat-value" id="totalPatients">12,450</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üè•</div>
                <div class="stat-label">–í—Å–µ–≥–æ –≤–∏–∑–∏—Ç–æ–≤</div>
                <div class="stat-value" id="totalVisits">62,250</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-label">–î–∏–∞–±–µ—Ç</div>
                <div class="stat-value" id="diabetesRate">8.2%</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìà</div>
                <div class="stat-label">BMI –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è</div>
                <div class="stat-value" id="bmiDiff">+6.2</div>
            </div>
        </div>

        <!-- –ì—Ä–∞—Ñ–∏–∫–∏ -->
        <div class="grid">
            <div class="card">
                <h2 class="card-title">üìä BMI: –î–∏–∞–±–µ—Ç–∏–∫–∏ vs –ù–µ-–¥–∏–∞–±–µ—Ç–∏–∫–∏</h2>
                <div class="chart-container">
                    <canvas id="bmiChart"></canvas>
                </div>
                <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                    <div style="text-align: center;">
                        <span style="color: #f72585; font-weight: bold;">32.1</span>
                        <span style="color: #6c757d; margin-left: 5px;">–î–∏–∞–±–µ—Ç–∏–∫–∏</span>
                    </div>
                    <div style="text-align: center;">
                        <span style="color: #4cc9f0; font-weight: bold;">25.9</span>
                        <span style="color: #6c757d; margin-left: 5px;">–ù–µ-–¥–∏–∞–±–µ—Ç–∏–∫–∏</span>
                    </div>
                    <div style="text-align: center;">
                        <span style="color: #4361ee; font-weight: bold;">+6.2</span>
                        <span style="color: #6c757d; margin-left: 5px;">–†–∞–∑–Ω–∏—Ü–∞</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">‚ùÑÔ∏è –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π</h2>
                <div class="chart-container">
                    <canvas id="seasonalityChart"></canvas>
                </div>
                <div style="display: flex; justify-content: space-around; margin-top: 20px;">
                    <div style="text-align: center;">
                        <span style="color: #4cc9f0; font-weight: bold;">41%</span>
                        <span style="color: #6c757d; margin-left: 5px;">–ì—Ä–∏–ø–ø –∑–∏–º–æ–π</span>
                    </div>
                    <div style="text-align: center;">
                        <span style="color: #f8961e; font-weight: bold;">12%</span>
                        <span style="color: #6c757d; margin-left: 5px;">–ì—Ä–∏–ø–ø –ª–µ—Ç–æ–º</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üè• –¢–æ–ø –¥–∏–∞–≥–Ω–æ–∑–æ–≤</h2>
                <div class="chart-container">
                    <canvas id="diagnosisChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ –¥–∏–∞–≥–Ω–æ–∑–∞–º</h2>
                <div class="chart-container">
                    <canvas id="costChart"></canvas>
                </div>
            </div>
        </div>

        <!-- –ò–Ω—Å–∞–π—Ç—ã -->
        <div class="card">
            <h2 class="card-title">üí° –ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div style="padding: 20px; background: #f8f9fa; border-radius: 12px;">
                    <h3 style="color: #4361ee; margin-bottom: 10px;">‚úì –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –¥–∏–∞–±–µ—Ç-BMI</h3>
                    <p style="color: #6c757d;">–î–∏–∞–±–µ—Ç–∏–∫–∏ –∏–º–µ—é—Ç BMI –Ω–∞ 6.2 –ø—É–Ω–∫—Ç–∞ –≤—ã—à–µ, —á–µ–º –Ω–µ-–¥–∏–∞–±–µ—Ç–∏–∫–∏. –≠—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É.</p>
                </div>
                <div style="padding: 20px; background: #f8f9fa; border-radius: 12px;">
                    <h3 style="color: #4361ee; margin-bottom: 10px;">‚ùÑÔ∏è –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≥—Ä–∏–ø–ø–∞</h3>
                    <p style="color: #6c757d;">–ó–∏–º–æ–π –∑–∞–±–æ–ª–µ–≤–∞–µ–º–æ—Å—Ç—å –≥—Ä–∏–ø–ø–æ–º –≤ 3.5 —Ä–∞–∑–∞ –≤—ã—à–µ, —á–µ–º –ª–µ—Ç–æ–º. –ü–∏–∫ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —è–Ω–≤–∞—Ä—å-—Ñ–µ–≤—Ä–∞–ª—å.</p>
                </div>
                <div style="padding: 20px; background: #f8f9fa; border-radius: 12px;">
                    <h3 style="color: #4361ee; margin-bottom: 10px;">üë¥ –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –¥–∏–∞–≥–Ω–æ–∑—ã</h3>
                    <p style="color: #6c757d;">25% –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ —Å—Ç–∞—Ä—à–µ 70 –ª–µ—Ç –±–æ–ª–µ—é—Ç –ø–Ω–µ–≤–º–æ–Ω–∏–µ–π, 90% –¥–µ—Ç–µ–π –¥–æ 12 –ª–µ—Ç - –ø—Ä–æ—Å—Ç—É–¥–æ–π.</p>
                </div>
            </div>
        </div>

        <!-- –§—É—Ç–µ—Ä -->
        <div class="footer">
            <p>Digital Twin Factory ¬© 2024 | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function initCharts() {
            // BMI Chart
            new Chart(document.getElementById('bmiChart'), {
                type: 'bar',
                data: {
                    labels: ['–î–∏–∞–±–µ—Ç–∏–∫–∏', '–ù–µ-–¥–∏–∞–±–µ—Ç–∏–∫–∏'],
                    datasets: [{
                        data: [32.1, 25.9],
                        backgroundColor: ['#f72585', '#4cc9f0'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });

            // Seasonality Chart
            new Chart(document.getElementById('seasonalityChart'), {
                type: 'line',
                data: {
                    labels: ['–Ø–Ω–≤', '–§–µ–≤', '–ú–∞—Ä', '–ê–ø—Ä', '–ú–∞–π', '–ò—é–Ω', '–ò—é–ª', '–ê–≤–≥', '–°–µ–Ω', '–û–∫—Ç', '–ù–æ—è', '–î–µ–∫'],
                    datasets: [
                        { 
                            label: '–ì—Ä–∏–ø–ø', 
                            data: [42, 40, 30, 20, 15, 10, 8, 9, 15, 25, 35, 41], 
                            borderColor: '#f72585', 
                            backgroundColor: 'rgba(247, 37, 133, 0.1)',
                            tension: 0.4 
                        },
                        { 
                            label: '–ü—Ä–æ—Å—Ç—É–¥–∞', 
                            data: [35, 33, 32, 30, 28, 25, 22, 23, 26, 30, 33, 36], 
                            borderColor: '#4cc9f0',
                            backgroundColor: 'rgba(76, 201, 240, 0.1)',
                            tension: 0.4 
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // Diagnosis Chart
            new Chart(document.getElementById('diagnosisChart'), {
                type: 'doughnut',
                data: {
                    labels: ['–ü—Ä–æ—Å—Ç—É–¥–∞', '–ì—Ä–∏–ø–ø', '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–î–∏–∞–±–µ—Ç', '–ê—Ä—Ç—Ä–∏—Ç'],
                    datasets: [{
                        data: [30, 25, 18, 15, 12],
                        backgroundColor: ['#4cc9f0', '#f72585', '#f8961e', '#4361ee', '#3f37c9']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // Cost Chart
            new Chart(document.getElementById('costChart'), {
                type: 'bar',
                data: {
                    labels: ['–ü–Ω–µ–≤–º–æ–Ω–∏—è', '–î–∏–∞–±–µ—Ç', '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–ì—Ä–∏–ø–ø', '–ü—Ä–æ—Å—Ç—É–¥–∞'],
                    datasets: [{
                        label: '–°—Ç–æ–∏–º–æ—Å—Ç—å ($)',
                        data: [350, 280, 200, 120, 80],
                        backgroundColor: ['#f72585', '#f8961e', '#4cc9f0', '#4361ee', '#4895ef'],
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadAnalytics() {
            try {
                const response = await fetch('/api/v1/stats');
                const stats = await response.json();
                
                document.getElementById('totalPatients').textContent = stats.total_patients?.toLocaleString() || '12,450';
                document.getElementById('totalVisits').textContent = stats.total_visits?.toLocaleString() || '62,250';
            } catch (error) {
                console.error('Error loading analytics:', error);
            }
        }

        window.onload = function() {
            initCharts();
            loadAnalytics();
        };
    </script>
</body>
</html>