<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Twin Factory - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</title>
    <link rel="stylesheet" href="/static/css/dark-theme.css">
    <link rel="stylesheet" href="/static/css/theme-switcher.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        .industry-header {
            background: var(--accent-gradient);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .industry-icon-large {
            font-size: 4rem;
            background: rgba(255,255,255,0.2);
            width: 100px;
            height: 100px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quick-switch {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .switch-btn {
            padding: 8px 16px;
            border-radius: 50px;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .switch-btn:hover {
            background: var(--accent-gradient);
            color: white;
        }
        
        .switch-btn.active {
            background: var(--accent-gradient);
            color: white;
        }
        
        .template-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .template-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-primary);
        }
        
        .industry-badge-current {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: var(--accent-gradient);
            color: white;
            border-radius: 50px;
            font-size: 1.1rem;
        }
    </style>
</head>
<body class="dark-theme">
    <div class="container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="navbar">
            <a href="/" class="navbar-brand">üè≠ Digital Twin Factory</a>
            <ul class="navbar-menu">
                <li class="navbar-item"><a href="/">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="navbar-item active"><a href="/generator">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä</a></li>
                <li class="navbar-item"><a href="/dashboard">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</a></li>
                <li class="navbar-item"><a href="/analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                <li class="navbar-item"><a href="/tariffs">–¢–∞—Ä–∏—Ñ—ã</a></li>
                <li class="navbar-item"><a href="#" onclick="logout()">–í—ã—Ö–æ–¥</a></li>
                <li class="navbar-item">
                    <div class="theme-switch-wrapper">
                        <label class="theme-switch">
                            <input type="checkbox" id="theme-toggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </li>
            </ul>
        </nav>

        <!-- –ò–Ω–¥—É—Å—Ç—Ä–∏—è-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Ö–µ–¥–µ—Ä -->
        <div class="industry-header" id="industryHeader">
            <div class="industry-icon-large" id="industryIcon">üè•</div>
            <div>
                <h1 style="color: white;">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è <span id="industryName">–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</span></h1>
                <p style="color: rgba(255,255,255,0.9);">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–π –æ—Ç—Ä–∞—Å–ª–∏</p>
            </div>
        </div>

        <!-- –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –æ—Ç—Ä–∞—Å–ª—è–º–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞) -->
        <div class="quick-switch" id="industrySwitcher" style="display: none;">
            <button class="switch-btn active" onclick="switchIndustry('healthcare')">üè• –ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</button>
            <button class="switch-btn" onclick="switchIndustry('finance')">üí∞ –§–∏–Ω–∞–Ω—Å—ã</button>
            <button class="switch-btn" onclick="switchIndustry('retail')">üõçÔ∏è –†–∏—Ç–µ–π–ª</button>
            <button class="switch-btn" onclick="switchIndustry('manufacturing')">üè≠ –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å</button>
        </div>

        <!-- –®–∞–±–ª–æ–Ω—ã –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –æ—Ç—Ä–∞—Å–ª–∏ -->
        <div class="grid">
            <div class="card" style="grid-column: span 2;">
                <h2 class="card-title">üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã</h2>
                <div class="grid" id="templatesList">
                    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <div class="card">
                <h2 class="card-title">üìä –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</h2>
                <div id="correlationsList">
                    <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä -->
        <div class="param-panel">
            <h2 style="margin-bottom: 25px;">‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</h2>
            
            <div class="grid" style="grid-template-columns: 1fr 1fr;">
                <div class="param-group">
                    <label class="form-label">üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π</label>
                    <input type="range" id="recordsSlider" class="param-slider" min="100" max="100000" value="10000">
                    <div class="param-limits">
                        <span>100</span>
                        <span id="recordsValue">10,000</span>
                        <span>100,000</span>
                    </div>
                </div>

                <div class="param-group">
                    <label class="form-label">üé≤ Seed</label>
                    <input type="range" id="seedSlider" class="param-slider" min="1" max="9999" value="42">
                    <div class="param-limits">
                        <span>1</span>
                        <span id="seedValue">42</span>
                        <span>9999</span>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary btn-lg" style="width: 100%;" onclick="startGeneration()">
                ‚ö° –°–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –î–ê–ù–ù–´–ï
            </button>
        </div>
    </div>

    <script>
        let currentUser = null;

        // –î–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ—Ç—Ä–∞—Å–ª–µ–π
        const industryData = {
            healthcare: {
                name: "–ó–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ",
                icon: "üè•",
                templates: [
                    {name: "–ü–∞—Ü–∏–µ–Ω—Ç—ã –∏ –≤–∏–∑–∏—Ç—ã", desc: "10k –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, 50k –≤–∏–∑–∏—Ç–æ–≤", icon: "üë•"},
                    {name: "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∏—Å—Ç–æ—Ä–∏–∏", desc: "–ò—Å—Ç–æ—Ä–∏–∏ –±–æ–ª–µ–∑–Ω–µ–π —Å –¥–∏–∞–≥–Ω–æ–∑–∞–º–∏", icon: "üìã"},
                    {name: "–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ –∞–Ω–∞–ª–∏–∑—ã", desc: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–æ–≤", icon: "üî¨"},
                    {name: "–í—ã–ø–∏—Å–∫–∏ —Ä–µ—Ü–µ–ø—Ç–æ–≤", desc: "–õ–µ–∫–∞—Ä—Å—Ç–≤–∞ –∏ –¥–æ–∑–∏—Ä–æ–≤–∫–∏", icon: "üíä"}
                ],
                correlations: [
                    "–î–∏–∞–±–µ—Ç ‚Üí BMI: +6.2",
                    "–ö—É—Ä–µ–Ω–∏–µ ‚Üí –†–∞–∫ –ª–µ–≥–∫–∏—Ö: +45%",
                    "–í–æ–∑—Ä–∞—Å—Ç ‚Üí –î–∞–≤–ª–µ–Ω–∏–µ: +0.5/–≥–æ–¥",
                    "–°–µ–∑–æ–Ω ‚Üí –ì—Ä–∏–ø–ø: x3.5 –∑–∏–º–æ–π"
                ],
                color: "#f72585"
            },
            finance: {
                name: "–§–∏–Ω–∞–Ω—Å—ã",
                icon: "üí∞",
                templates: [
                    {name: "–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏", desc: "10k —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π", icon: "üí≥"},
                    {name: "–ö—Ä–µ–¥–∏—Ç–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏", desc: "–ö–ª–∏–µ–Ω—Ç—ã –∏ –∏—Ö –∫—Ä–µ–¥–∏—Ç—ã", icon: "üìä"},
                    {name: "–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ—Ä—Ç—Ñ–µ–ª–∏", desc: "–ê–∫—Ü–∏–∏ –∏ –æ–±–ª–∏–≥–∞—Ü–∏–∏", icon: "üìà"},
                    {name: "–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏", desc: "–ê–Ω–æ–º–∞–ª–∏–∏ –∏ —Ñ—Ä–æ–¥", icon: "üö®"}
                ],
                correlations: [
                    "–î–æ—Ö–æ–¥ ‚Üí –°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞: r=0.78",
                    "–í–æ–∑—Ä–∞—Å—Ç ‚Üí –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏: U-–æ–±—Ä–∞–∑–Ω–∞—è",
                    "–†–µ–≥–∏–æ–Ω ‚Üí –ü—Ä–æ—Å—Ä–æ—á–∫–∏: +25%",
                    "–°–µ–∑–æ–Ω ‚Üí –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ: +15% –≤ –¥–µ–∫"
                ],
                color: "#f8961e"
            },
            retail: {
                name: "–†–∏—Ç–µ–π–ª",
                icon: "üõçÔ∏è",
                templates: [
                    {name: "–ü–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ—Ä–∑–∏–Ω—ã", desc: "–¢–æ–≤–∞—Ä—ã –∏ —á–µ–∫–∏", icon: "üõí"},
                    {name: "–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –±–∞–∑–∞", desc: "–ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π", icon: "üë§"},
                    {name: "–°–∫–ª–∞–¥—Å–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏", desc: "–¢–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ", icon: "üì¶"},
                    {name: "–¶–µ–Ω–æ–≤–∞—è –¥–∏–Ω–∞–º–∏–∫–∞", desc: "–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω", icon: "üè∑Ô∏è"}
                ],
                correlations: [
                    "–°–∫–∏–¥–∫–∞ ‚Üí –ü—Ä–æ–¥–∞–∂–∏: +35%",
                    "–°–µ–∑–æ–Ω ‚Üí –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –æ–¥–µ–∂–¥–∞ ¬±40%",
                    "–í–æ–∑—Ä–∞—Å—Ç ‚Üí –ë—Ä–µ–Ω–¥: –ø—Ä–µ–º–∏—É–º 45+",
                    "–ì–µ–æ ‚Üí –¢–æ–≤–∞—Ä—ã: —Ä–µ–≥–∏–æ–Ω.—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞"
                ],
                color: "#4cc9f0"
            },
            manufacturing: {
                name: "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å",
                icon: "üè≠",
                templates: [
                    {name: "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã", desc: "–ü–∞—Ä—Ç–∏–∏ –ø—Ä–æ–¥—É–∫—Ü–∏–∏", icon: "‚öôÔ∏è"},
                    {name: "–î–∞–Ω–Ω—ã–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è", desc: "–°—Ç–∞–Ω–∫–∏ –∏ –¥–∞—Ç—á–∏–∫–∏", icon: "üîß"},
                    {name: "–ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞", desc: "–ë—Ä–∞–∫ –∏ –¥–µ—Ñ–µ–∫—Ç—ã", icon: "‚úÖ"},
                    {name: "–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–ª–æ–º–æ–∫", desc: "–¢–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ", icon: "‚ö†Ô∏è"}
                ],
                correlations: [
                    "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ ‚Üí –ë—Ä–∞–∫: +2%/¬∞C",
                    "–ò–∑–Ω–æ—Å ‚Üí –ü–æ–ª–æ–º–∫–∏: —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–∞",
                    "–°–º–µ–Ω–∞ ‚Üí –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: -15%",
                    "–í–ª–∞–∂–Ω–æ—Å—Ç—å ‚Üí –ö–∞—á–µ—Å—Ç–≤–æ: –æ–±—Ä–∞—Ç–Ω–∞—è"
                ],
                color: "#4361ee"
            }
        };

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUser() {
            const token = localStorage.getItem('token');
            if (!token) {
                window.location.href = '/login';
                return;
            }

            try {
                const response = await fetch('/api/v1/auth/me', {
                    headers: {'Authorization': `Bearer ${token}`}
                });
                if (response.ok) {
                    currentUser = await response.json();
                    loadIndustryData(currentUser.industry);
                    
                    // –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ—Ç—Ä–∞—Å–ª–µ–π
                    if (currentUser.is_developer) {
                        document.getElementById('industrySwitcher').style.display = 'flex';
                    }
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç—Ä–∞—Å–ª–∏
        function loadIndustryData(industryId) {
            const data = industryData[industryId] || industryData.healthcare;
            
            document.getElementById('industryIcon').textContent = data.icon;
            document.getElementById('industryName').textContent = data.name;
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∞–±–ª–æ–Ω—ã
            const templatesList = document.getElementById('templatesList');
            templatesList.innerHTML = data.templates.map(t => `
                <div class="template-card" onclick="selectTemplate('${t.name}')">
                    <div style="font-size: 2rem; margin-bottom: 10px;">${t.icon}</div>
                    <h3>${t.name}</h3>
                    <p style="color: var(--text-muted);">${t.desc}</p>
                </div>
            `).join('');
            
            // –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
            const correlationsList = document.getElementById('correlationsList');
            correlationsList.innerHTML = data.correlations.map(c => `
                <div style="margin: 10px 0; padding: 10px; background: var(--bg-secondary); border-radius: 8px;">
                    <span style="color: ${data.color};">üìä</span> ${c}
                </div>
            `).join('');
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç—Ä–∞—Å–ª–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞)
        function switchIndustry(industryId) {
            document.querySelectorAll('.switch-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            loadIndustryData(industryId);
        }

        function selectTemplate(name) {
            alert(`–í—ã–±—Ä–∞–Ω —à–∞–±–ª–æ–Ω: ${name}`);
        }

        function startGeneration() {
            alert('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–ø—É—â–µ–Ω–∞!');
        }

        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            window.location.href = '/';
        }

        window.onload = loadUser;
    </script>
</body>
</html>
